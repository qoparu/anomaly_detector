# System Anomaly Detector

A project for the "Data Collection and Machine Learning for Critical Cyber-Physical Systems" course. [cite_start]This repository contains the code to build an end-to-end anomaly detector for a standalone system, such as a laptop or workstation[cite: 2, 5].

[cite_start]The software monitors system performance indicators in real-time, uses a machine learning model to classify system behavior as 'Normal' or 'Anomalous', and logs the results[cite: 7, 12, 13].

## Project Goal

[cite_start]The primary aim is to develop a complete detection system in three main steps[cite: 4]:
1.  [cite_start]**Monitor:** Continuously read specific performance indicators (e.g., CPU load, memory usage) from the system[cite: 11].
2.  [cite_start]**Analyze:** Train and use a machine learning model for binary classification to distinguish between normal and anomalous behavior[cite: 12].
3.  [cite_start]**Detect & Log:** Implement the trained model for real-time detection and log the predictions along with the monitored data[cite: 13, 30].

## Project Structure
/
├── monitor.py           # Module to collect system metrics (CPU, RAM, etc.)
├── anomaly_injector.py  # Script to simulate high CPU load for generating anomaly data
├── run_collection.py    # Main script to generate the training dataset (training_data.csv)
├── train.py             # (Future) Script for training the ML model
├── detector.py          # (Future) Script for real-time anomaly detection
├── requirements.txt     # List of Python dependencies
└── README.md            # This file

## Setup & Installation

1.  **Clone the repository** (or create the files manually):
    ```bash
    git clone <your-repo-url>
    cd <your-repo-name>
    ```

2.  **Create `requirements.txt`**: Create a file named `requirements.txt` and add the following lines:
    ```
    psutil
    pandas
    scikit-learn
    tensorflow
    ```

3.  **Install dependencies**:
    ```bash
    pip install -r requirements.txt
    ```

## Usage

The first phase of the project is to generate a labeled dataset for training the machine learning model.

### Phase 1: Generating the Training Dataset

The `run_collection.py` script orchestrates data collection by recording normal system behavior first, followed by anomalous behavior, which is generated by `anomaly_injector.py`.

**Follow these steps:**

1.  Open **two** separate terminal windows (or command prompts).

2.  In **Terminal 1**, run the data collection script. It will start gathering data for normal activity and then pause, waiting for you to start the anomaly.
    ```bash
    python run_collection.py
    ```
    You will see output indicating that it's collecting 'normal' data, after which it will display the message: `[*] Сейчас будет запущена аномалия. Нажмите Enter для продолжения...` (which means "The anomaly will be launched now. Press Enter to continue..."). **Do not press Enter yet.**

3.  In **Terminal 2**, run the anomaly injector script. This will start a process that puts a heavy load on your CPU. You may hear your computer's fans speed up.
    ```bash
    python anomaly_injector.py
    ```

4.  Switch back to **Terminal 1** and press `Enter`. The script will now begin collecting data while the system is under the anomalous load.

5.  Once both scripts have finished, a new file named `training_data.csv` will be created in the project directory. This file contains the labeled data required for the next phase.

## Next Steps

1.  **Implement `train.py`:**
    * Load the `training_data.csv` file.
    * Train and compare several machine learning models (e.g., Isolation Forest, Random Forest, and a Neural Network using TensorFlow/Keras).
    * Evaluate the models using appropriate metrics (Precision, Recall, F1-Score).
    * Save the best-performing model to a file (e.g., `best_model.joblib` or `best_model.h5`).

2.  **Implement `detector.py`:**
    * Load the saved model.
    * Use the `get_system_metrics()` function from `monitor.py` to get live data in a loop.
    * Feed the live data to the model to get real-time predictions.
    * Print the prediction ('Normal' or 'ANOMALY DETECTED!') to the console.

## License

This project is licensed under the MIT License.
